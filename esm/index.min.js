for(var key,isNodeJS="object"==typeof process&&!process.browser,parse=isNodeJS?function(e,r){function t(r){return"string"==typeof r?e(r):r}return function(){return r.call(arguments,t)}}(require("echomd").raw,[].map):function(e){var r,t,o,n,a,c,s=(Object.create||Object)(null),l=transform.multiLineCode.re,i=transform.singleLineCode.re,d=function(e,r,t,o){return o=o.replace(/%c/g,"%%c"),r+t+(s[o]=md5Base64(o))+t},p=function(e,r,t,o){return r+"%c"+getSource(o,s)+"%c"},u=[];for(match(e,"multiLineCode",u),e=e.replace(l,d),match(e,"singleLineCode",u),e=e.replace(i,d),match(e,"header2",u),match(e,"header1",u),match(e,"blink",u),match(e,"bold",u),match(e,"dim",u),match(e,"hidden",u),match(e,"reverse",u),match(e,"strike",u),match(e,"underline",u),match(e,"color",u),e=e.replace(/^[ ]{0,2}([ ]?[*_-][ ]?){3,}[ \t]*$/gm,line),e=replace(e,"header2"),e=replace(e,"header1"),e=replace(e,"blink"),e=replace(e,"bold"),e=replace(e,"dim"),e=replace(e,"hidden"),e=replace(e,"reverse"),e=replace(e,"strike"),e=(e=(e=replace(e,"underline")).replace(/^([ \t]{1,})[*+-]([ \t]{1,})/gm,"$1•$2")).replace(/^[ \t]*>([ \t]?)/gm,function(e,r){return Array(r.length+1).join("▌")+r}),r=[e=(e=(e=(e=replace(e,"color")).replace(/(%c)+/g,"%c")).replace(i,p)).replace(l,p)],n=u.length,t=0;t<n;t++){for(a="",c="",o=t;o<n;o++)if(t=o,o in u){if(c&&c!==u[o].k){t--;break}c=u[o].k,a+=u[o].v}a&&r.push(a)}return r},line=Array(33).join("─"),md5Base64=function(e){for(var r=[],t=0;t<e.length;t++)r[t]=e.charCodeAt(t).toString(32);return r.join("").slice(0,e.length)},getSource=function(e,r){for(var t in r)if(r[t]===e)return t},commonReplacer=function(e,r,t,o){return"%c"+t+o+"%c"},match=function(e,r,t){for(var o,n,a=transform[r];n=a.re.exec(e);)t[o=n.index]={k:"start",v:"string"==typeof a.start?a.start:a.start(n)},t[o=o+n[0].length-1]={k:"end",v:"string"==typeof a.end?a.end:a.end(n)}},replace=function(e,r){var t=transform[r];return e.replace(t.re,t.place)},transform={blink:{re:/(\:{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"padding:0 2px;border:1px solid darkslategray;text-shadow:0 0 2px darkslategray;",end:"padding:none;border:none;text-shadow:none;"},bold:{re:/(\*{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"font-weight:bold;",end:"font-weight:default;"},color:{re:/(!?)#([a-zA-Z0-9]{3,8})\((.+?)\)(?!\))/g,place:function(e,r,t,o){return"%c"+o+"%c"},start:function(e){return(e[1]?"background-":"")+"color:"+(/^[a-fA-F0-9]{3,8}$/.test(e[2])?"#":"")+e[2]+";"},end:function(e){return(e[1]?"background-":"")+"color:initial;"}},dim:{re:/(-{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"color:dimgray;",end:"color:none;"},header1:{re:/^(\#[ \t]+)(.+?)[ \t]*\#*([\r\n]+|$)/gm,place:commonReplacer,start:"font-weight:bold;font-size:1.6em;",end:"font-weight:default;font-size:default;"},header2:{re:/^(\#{2,6}[ \t]+)(.+?)[ \t]*\#*([\r\n]+|$)/gm,place:commonReplacer,start:"font-weight:bold;font-size:1.3em;",end:"font-weight:default;font-size:default;"},hidden:{re:/(\?{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"color:rgba(0,0,0,0);",end:"color:none;"},reverse:{re:/(\!{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"padding:0 2px;background:darkslategray;color:lightgray;",end:"padding:none;background:none;color:none;"},multiLineCode:{re:/(^|[^\\])(`{2,})([\s\S]+?)\2(?!`)/g,start:"font-family:monospace;",end:"font-family:default;"},singleLineCode:{re:/(^|[^\\])(`)(.+?)\2/gm,start:"font-family:monospace;",end:"font-family:default;"},strike:{re:/(~{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"text-decoration:line-through;",end:"text-decoration:default;"},underline:{re:/(_{1,2})(?=\S)(.*?)(\S)\1/g,place:commonReplacer,start:"border-bottom:1px solid;",end:"border-bottom:default;"}},overwrite=function(e){var r=console[e];r&&((consolemd[e]=isNodeJS?function(){return r.apply(console,parse.apply(null,arguments))}:function(){var e=1===arguments.length&&"string"==typeof arguments[0]?parse(arguments[0]):arguments;if(_reporter){var t,o=e[0],n=e.slice(1),a=/%c(.*?)(?=%c|$)/g,c=0;for(_reporter.init();null!==(t=a.exec(o));){var s=a.lastIndex,l=t[0];if(l.length>2){var i=s-l.length;if(i>c){var d=o.slice(c,i);_reporter.report(d)}_reporter.report(l.slice(2),n.splice(0,1)[0])}c=s}if(c<o.length){d=o.slice(c);_reporter.report(d)}_reporter.done(e)}return r.apply(console,e)}).raw=function(){return r.apply(console,arguments)})},consolemd={},methods=["error","info","log","warn"],i=0;i<methods.length;i++)overwrite(methods[i]);try{for(key in overwrite=function(e){return function(){return e.apply(console,arguments)}},console)consolemd.hasOwnProperty(key)||(consolemd[key]=overwrite(console[key]))}catch(e){for(i=0;i<methods.length;i++)key=methods[i],console[key].raw||(console[key]=consolemd[key])}var _reporter=null,addReporter=function(e){_reporter=e};class HTMLReporter{constructor(e,r){r=r||{},this.context=e||document.body,this.allowHTML=r.allowHTML}init(){this.container=document.createElement("li")}report(e,r){if(r){var t=document.createElement("span");t.setAttribute("style",r),t[this.allowHTML?"innerHTML":"textContent"]=e,this.container.append(t)}else this.container.append(e)}done(e){this.context.append(this.container)}}function tressa(e,r){try{console.assert.apply(console,arguments),e||(tressa.exitCode=1),"string"==typeof r&&e&&tressa.console.log("#green(✔) "+r)}catch(e){tressa.exitCode=1,tressa.console.error("#red(✖) "+e)}}tressa.title=function(e){tressa.testName=e,tressa.console.info("# "+e),console.time(e)},tressa.async=function(e,r){var t=Object,o=Object,n=setTimeout(function(){var t="*timeout ("+(r||tressa.timeout)+"ms)* "+(e.name||e);o(t),tressa(!1,t)},r||tressa.timeout);return setTimeout(function(){e(function(){t.apply(null,arguments),clearTimeout(n)})}),"undefined"!=typeof Promise?new Promise(function(e,r){t=e,o=r}):null},tressa.timeout=1e4,tressa.assert=tressa.sync=tressa,tressa.console=consolemd,tressa.log=tressa.console.log,tressa.end=function(){var e=tressa.testName;e&&(tressa.console.log(Array(e.length+10).join("─")),console.timeEnd(e),tressa.console.log(""),tressa.testName="")};try{process.browser||(process.on("exit",function(){tressa.end(),process.exit(tressa.exitCode||0)}),process.on("uncaughtException",function(e){tressa.exitCode=1,tressa.console.error("#red(✖) "+e),process.emit("exit")}))}catch(e){}const addHTMLReporter=function(e,r){addReporter(new HTMLReporter(e,r))};export default tressa;export{addHTMLReporter};
